<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yunting.client.mapper.OperationRecordlistMapper">
    <resultMap id="BaseResultMap" type="com.yunting.client.entity.OperationRecordlist">
        <id column="operation_id" property="operationId" jdbcType="INTEGER"/>
        <id column="appid" property="appid" jdbcType="BIGINT"/>
        <id column="wx_open_id" property="wxOpenId" jdbcType="VARCHAR"/>
        <result column="player_id" property="playerId" jdbcType="BIGINT"/>
        <result column="wx_nickname" property="wxNickname" jdbcType="VARCHAR"/>
        <result column="operation_reason" property="operationReason" jdbcType="VARCHAR"/>
        <result column="operation_type" property="operationType" jdbcType="VARCHAR"/>
        <result column="operation_time" property="operationTime" jdbcType="TIMESTAMP"/>
    </resultMap>
    <insert id="insert">
        insert into operation_recordlist (operation_id, wx_open_id, player_id,
                                          wx_nickname, operation_reason, operation_time, operation_type)
        values (#{operationId}, #{wxOpenId,jdbcType=VARCHAR}, #{playerId,jdbcType=BIGINT},
                #{wxNickname,jdbcType=VARCHAR}, #{operationReason,jdbcType=VARCHAR},
                #{operationTime,jdbcType=TIMESTAMP},
                #{operationType})
    </insert>
    <select id="selectAllRecordByCondition" resultType="com.yunting.client.entity.OperationRecordlist">
        select operation_id,wx_open_id,player_id,wx_nickname,operation_reason,operation_time,operation_type
        from operation_recordlist
        where operation_id= operation_id and appid= #{active.appid}
        <if test="active.selectOption != ''">

            <if test="active.selectOption == 1">
                <if test="active.search != ''">
                    and player_id=#{active.search}
                </if>
            </if>

            <if test="active.selectOption == 2">
                <if test="active.search != ''">
                    and wx_nickname=#{active.search}
                </if>
            </if>

            <if test="active.startTime!=''&amp;&amp;active.endTime!=''">
                and operation_time between #{active.startTime} and #{active.endTime}
            </if>
        </if>
        order by operation_id desc
    </select>

    <update id="changeOperationRecord">
        UPDATE operation_recordlist
        SET operation_reason = #{operationMsg}
        WHERE operation_id = #{operationId}
    </update>


</mapper>